<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>è¨‚å–®æˆç«‹ - åˆä½œç¤¾å•†åŸ</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>è¨‚å–®æˆç«‹</h1>
    <div>
      <a href="index.html">å›å•†åŸ</a>
      <span id="memberArea"></span>
      <span class="cart-icon" onclick="window.location.href='cart.html'">
        ğŸ›’
        <span id="cart-count" class="cart-badge"></span>
      </span>
    </div>
  </header>

  <main class="container">
    <h2>æ„Ÿè¬æ‚¨çš„è¨‚è³¼ï¼</h2>
    <p>æ‚¨çš„è¨‚å–®å·²æˆåŠŸæˆç«‹ ğŸ‰</p>
    <p>è¨‚å–®ç·¨è™Ÿï¼š<strong id="order-id"></strong></p>
    <p>è¨‚å–®é‡‘é¡ï¼š<strong id="order-total"></strong></p>

    <div id="order-detail" class="order-box"></div>

    <a href="index.html" class="btn">å›å•†åŸé¦–é </a>
  </main>

  <footer>
    <p>Â© 2025 è¾²æ¥­åˆä½œç¤¾å•†åŸ</p>
  </footer>

  <script src="config.js"></script>
  <script src="member.js"></script>
  <script src="cart-utils.js"></script>
  <script>
    // å–å¾—ç¶²å€åƒæ•¸
    function getParam(key) {
      return new URLSearchParams(window.location.search).get(key);
    }

    // é¡¯ç¤ºè¨‚å–®
    function loadOrder() {
      const orderId = getParam("order_id");
      const total = getParam("total");

      document.getElementById("order-id").textContent = orderId || "-";
      document.getElementById("order-total").textContent = total ? `$${total}` : "-";

      if (!orderId) return;

      // ğŸ” å‘ GAS æŸ¥è©¢è¨‚å–®
      callGAS({ type: "getOrder", order_id: orderId }, res => {
        const box = document.getElementById("order-detail");
        if (res.status === "ok" && res.order) {
          const o = res.order;
          box.innerHTML = `
            <h3>è¨‚å–®æ˜ç´°</h3>
            <p>å§“åï¼š${o.name}</p>
            <p>é›»è©±ï¼š${o.phone}</p>
            <p>åœ°å€ï¼š${o.address}</p>
            <p>ç¸½é‡‘é¡ï¼š$${o.total}</p>
            <p>å•†å“å…§å®¹ï¼š${o.items}</p>
            <p>ä¸‹å–®æ™‚é–“ï¼š${o.date}</p>
          `;
        } else {
          box.innerHTML = `<p style="color:red;">æŸ¥è©¢å¤±æ•—ï¼š${res.message || "ä¼ºæœå™¨ç„¡å›æ‡‰"}</p>`;
        }
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      updateMemberArea();
      updateCartCount();
      loadOrder();
    });
  </script>

  <style>
    .order-box {
      background: #fff8f0;
      padding: 16px;
      margin-top: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      line-height: 1.8;
    }
    .btn {
      display: inline-block;
      margin-top: 20px;
      background: #3b7c3a;
      color: #fff;
      padding: 10px 18px;
      border-radius: 6px;
      text-decoration: none;
    }
    .btn:hover {
      background: #2f642f;
    }
  </style>
</body>
</html>
